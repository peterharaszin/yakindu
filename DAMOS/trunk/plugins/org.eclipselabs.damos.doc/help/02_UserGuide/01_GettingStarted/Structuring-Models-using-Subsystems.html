<?xml version='1.0' encoding='utf-8' ?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Getting Started - Structuring Models using Subsystems</title><link type="text/css" rel="stylesheet" href="../content/PLUGINS_ROOT/PRODUCT_PLUGIN/book.css"/><link type="text/css" rel="stylesheet" href="../../style.css"/></head><body><table class="navigation" style="width: 100%;" border="0" summary="navigation"><tr><th style="width: 100%" align="center" colspan="3">Structuring Models using Subsystems</th></tr><tr><td style="width: 20%" align="left"><a href="Generating-C-Code.html" title="Generating C Code"><img alt="Previous" border="0" src="images/prev.gif"/></a></td><td style="width: 60%" align="center"></td><td style="width: 20%" align="right"></td></tr><tr><td style="width: 20%" align="left" valign="top">Generating C Code</td><td style="width: 60%" align="center"></td><td style="width: 20%" align="right" valign="top"></td></tr></table><hr/><h1 id="StructuringModelsusingSubsystems">Structuring Models using Subsystems</h1><p>In this topic you will learn how to structure Damos models for better clarity and reusability. For illustration purposes we will reuse the example model of the previous topic. Therefore, before starting this topic, you should have a working model of the previous topic.</p><p>The goal will be to create an enclosing model for the cruise control model, which contains the cruise control model as a subsystem. The enclosing model will include blocks that describe the physical environment (e.g. a car) of the cruise control. This will allow us to simulate the cruise control model within its environment.</p><h2 id="CreatingaSystemInterface">Creating a System Interface</h2><p>Before we can add the cruise control subsystem to our environment model, we need to define the <em>system interface</em> of our cruise control model. To create the system interface:</p><ol><li>Right-click on the <em>CruiseControl.blockdiagram</em> file and select <strong>New &gt; Other...</strong> to open the <strong>New</strong> wizard.</li><li>Select <strong>Damos &gt; System Interface</strong> and then click <strong>Next</strong> to start the <strong>New System Interface</strong> wizard: <img alt="New System Interface Wizard" title="New System Interface Wizard" border="0" src="03_StructuringModels_images/NewSystemInterface.png"/></li><li>Keep the default name <em>CruiseControl</em> and click <strong>Finish</strong>.</li></ol><p>After clicking <strong>Finish</strong>, the new system interface definition will be opened in a text editor. It should have the following contents:</p><pre><code>package cruisecontrol

systemInterface CruiseControl {

	inlet real DesiredSpeed
	inlet real ActualSpeed

	outlet real Power

}
</code></pre><p>The <code>inlet</code> and <code>outlet</code> declarations are used to specify the inputs and outputs of the cruise control subsystem.</p><h2 id="CreatingtheEnvironmentModel">Creating the Environment Model</h2><p>To create the environment model:</p><ol><li>Create a new block diagram in the model folder (right-click on the model folder <strong>New &gt; Other...</strong> and then <strong>Damos &gt; Block Diagram</strong>) with the name <em>Environment</em>.</li><li>Use the subsystem creation tool from the <strong>General</strong> palette drawer to create a new subsystem. When releasing the mouse on the block diagram, the system interface selection dialog will appear: <img alt="Select System Interface Dialog" title="Select System Interface Dialog" border="0" src="03_StructuringModels_images/SelectSystemInterface.png"/></li><li>Select <em>CruiseControl.systeminterface</em> and click <strong>OK</strong>.</li></ol><p>A subsystem <em>CruiseControl</em> has now been added to the block diagram. Note that the subsystem has a dashed border, which means that no <em>subsystem realization</em> has been specified. To specify the subsystem realization:</p><ol><li>Right-click on the subsystem and select <strong>Change Realization...</strong>.</li><li>In the <strong>Change Subsystem Realization</strong> dialog, enable the <strong>Provide subsystem realization</strong> check box.</li><li>Click the <strong>Load...</strong> button.</li><li>In the <strong>Select Block Diagram</strong> dialog, select <em>CruiseControl.blockdiagram</em> and then click <strong>OK</strong>.</li><li>Back in the <strong>Change Subsystem Realization</strong> dialog, select <strong>CruiseControl</strong> as the realizing fragment: <img alt="Change Subsystem Realization Dialog" title="Change Subsystem Realization Dialog" border="0" src="03_StructuringModels_images/ChangeSubsystemRealization.png"/></li><li>Click <strong>OK</strong>.</li></ol><p>The block diagram should now look as follows (notice the solid subsystem border):</p><p><img alt="Initial Environment Model" title="Initial Environment Model" border="0" src="03_StructuringModels_images/InitialEnvironmentModel.png"/></p><p>Finally, we need to add the following blocks:</p><ul><li><strong>Step</strong> block with initial value of <code>0</code>, final value of <code>100</code>, and step time of <code>1(s)</code></li><li><strong>Transfer Function</strong> block with numerator coefficient of <code>{ 200 }</code> and denominator coefficients of <code>{ 10, 1 }</code></li><li>2 <strong>Scope</strong> blocks</li></ul><p>After connecting the blocks, the block diagram should look as follows:</p><p><img alt="Final Environment Model" title="Final Environment Model" border="0" src="03_StructuringModels_images/FinalEnvironmentModel.png"/></p><h2 id="SimulatingtheEnvironmentModel">Simulating the Environment Model</h2><p>To simulate the cruise control model within its environment model, select <strong>Run &gt; Run As &gt; Damos Simulation</strong> or click the <strong>Run</strong> (<img border="0" src="01_CreatingModel_images/run_exc.gif"/>) icon in the toolbar. The simulation result should look as follows:</p><p><img alt="Simulation Result" title="Simulation Result" border="0" src="03_StructuringModels_images/SimulationResult.png"/></p><p><em>Note:</em> If you get an error stating that the sample time could not be resolved for certain blocks, you probably forgot to set the sample time on the leftmost Sum block of your cruise control model (see previous topic for more details).</p><hr/><table class="navigation" style="width: 100%;" border="0" summary="navigation"><tr><td style="width: 20%" align="left"><a href="Generating-C-Code.html" title="Generating C Code"><img alt="Previous" border="0" src="images/prev.gif"/></a></td><td style="width: 60%" align="center"><a href="GettingStarted.html" title="Getting Started"><img alt="Getting Started" border="0" src="images/home.gif"/></a></td><td style="width: 20%" align="right"></td></tr><tr><td style="width: 20%" align="left" valign="top">Generating C Code</td><td style="width: 60%" align="center"></td><td style="width: 20%" align="right" valign="top"></td></tr></table></body></html>