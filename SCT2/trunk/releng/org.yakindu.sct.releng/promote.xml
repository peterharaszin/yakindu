<project name="promote.xml" default="promote" basedir=".">

	<property environment="env" />
	<property file="run.properties" />
	<property file="promote.properties" />

	<target name="fetch_old_repo">
		<mkdir dir="${local.update.site}" />
		<scp todir="${local.update.site}" keyfile="${yakindu.keyFile}" failonerror="${scp.fail_on_error}" passphrase="${yakindu.passphrase}" trust="true" file="${env.promotionTarget}" sftp="true">
		</scp>
	</target>
	
	<target name="mirror" >
		<echo message="Mirroring update site from ${env.promotionSource} tp" />
	</target>

	<target name="promote">
		<echo message="Fetching existing update-site from ${env.promotionTarget} to local update site ..." />
		<antcall target="fetch_old_repo"/>
	
	    <echo message="Mirroring ${env.promotionTarget} into local upate site ..." />
		<antcall target="mirror"/>
		
		<echo message="Promoting merged local update site to ${env.promotionTarget}" />
	</target>

</project>